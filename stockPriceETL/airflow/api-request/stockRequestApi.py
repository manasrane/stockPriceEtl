import requests
import json
import pandas as pd
api_key = "<placholder>"  # <placholder> # Replace with your actual API key


# Base function to hit Alpha Vantage API
def fetch_alpha_vantage(function, symbol=None, interval=None, outputsize="compact", keywords=None):
    base_url = "https://www.alphavantage.co/query"
    params = {
        "function": function,
        "apikey": api_key
    }
    if symbol:
        params["symbol"] = symbol
    if interval:
        params["interval"] = interval
    if outputsize:
        params["outputsize"] = outputsize
    if keywords:
        params["keywords"] = keywords

    try:
        print("üîó Fetching data from Alpha Vantage...")
        #print("url:", base_url, "params:", params)
        response = requests.get(base_url, params=params)
        print("urlFired:", response.url)
        response.raise_for_status()
        if response.json().get("Information"):
            print("‚ö†Ô∏è API Limit Reached. Please try again later.")
            return None
        return response.json()
    except requests.RequestException as e:
        print(f"‚ùå API Error: {e}")
        return None

def parse_time_series(data, time_key):
    time_series = data.get(time_key, {})
    if not time_series:
        print("‚ö†Ô∏è No time series data found.")
        return None

    return time_series

def get_intraday(symbol, interval): 
    data = fetch_alpha_vantage("TIME_SERIES_INTRADAY", symbol=symbol, interval=interval)
    return parse_time_series(data, f"Time Series ({interval})")

def get_weekly(symbol):
    data = fetch_alpha_vantage("TIME_SERIES_WEEKLY", symbol=symbol)
    return parse_time_series(data, "Weekly Time Series")

def get_monthly(symbol):
    data = fetch_alpha_vantage("TIME_SERIES_MONTHLY", symbol=symbol)
    return parse_time_series(data, "Monthly Time Series")

def get_global_quote(symbol):
    data = fetch_alpha_vantage("GLOBAL_QUOTE", symbol=symbol)
    return data.get("Global Quote", {})


def search_symbol(keywords):
    data = fetch_alpha_vantage("SYMBOL_SEARCH", keywords=keywords)
    return data.get("bestMatches", [])

def get_market_status():
    data = fetch_alpha_vantage("MARKET_STATUS")
    return data.get("market_status", data)  # fallback to entire response

def requestApi(Symbol,interval):
    # Get intraday 5min data for IBM
    df_intraday = get_intraday(Symbol,interval) # 1min, 5min, 15min, 30min, 60min
    #print(df_intraday.head())

    # Weekly
    df_weekly = get_weekly(Symbol)

    # Monthly
    df_monthly = get_monthly(Symbol)

    # Global quote
    quote = get_global_quote(Symbol)
    #print("Price:", quote.get("05. price"))

    # Symbol search
    search_results = search_symbol(Symbol)
    #print(search_results.head())

    # Market status
    status = get_market_status()
    #print(status)
    return {
        "intraday": df_intraday,
        "weekly": df_weekly,
        "monthly": df_monthly,
        "global_quote": quote,
        "search_results": search_results,
        "market_status": status
    }
#data = requestApi("IBM","5min")
"""# Save the data to a file for debugging purposes
with open("output.txt", "w") as f:
    f.write(json.dumps(data, indent=2))

# Example usage:
def requestApi(Symbol,interval):
    data = {}
    print(Symbol,interval)
    outputpath ="/opt/airflow/dags/output.txt"
    with open(outputpath, "r") as f:
        data = json.load(f)
    #print(data)
    return {"intraday":{"2025-07-11 19:55:00":{"1. open":"283.5300","2. high":"283.5699","3. low":"283.5300","4. close":"283.5699","5. volume":"8"},"2025-07-11 19:50:00":{"1. open":"283.4500","2. high":"283.5688","3. low":"283.4500","4. close":"283.5688","5. volume":"3"},"2025-07-11 19:45:00":{"1. open":"283.3000","2. high":"283.5700","3. low":"283.3000","4. close":"283.5700","5. volume":"3"},"2025-07-11 19:40:00":{"1. open":"283.5700","2. high":"283.5700","3. low":"283.5700","4. close":"283.5700","5. volume":"1"},"2025-07-11 19:35:00":{"1. open":"283.5700","2. high":"283.5700","3. low":"283.5700","4. close":"283.5700","5. volume":"1"},"2025-07-11 19:30:00":{"1. open":"283.2000","2. high":"283.2000","3. low":"283.2000","4. close":"283.2000","5. volume":"24"},"2025-07-11 19:25:00":{"1. open":"283.4000","2. high":"283.4000","3. low":"283.2000","4. close":"283.2000","5. volume":"8"},"2025-07-11 19:20:00":{"1. open":"283.5700","2. high":"283.5700","3. low":"283.2000","4. close":"283.2000","5. volume":"5"},"2025-07-11 19:15:00":{"1. open":"283.5600","2. high":"283.5600","3. low":"283.5600","4. close":"283.5600","5. volume":"1"},"2025-07-11 19:05:00":{"1. open":"283.5699","2. high":"283.5699","3. low":"283.2000","4. close":"283.2000","5. volume":"86"},"2025-07-11 19:00:00":{"1. open":"283.5900","2. high":"283.5900","3. low":"283.4000","4. close":"283.5700","5. volume":"776637"},"2025-07-11 18:55:00":{"1. open":"283.4500","2. high":"283.4500","3. low":"283.4400","4. close":"283.4400","5. volume":"385"},"2025-07-11 18:50:00":{"1. open":"283.5700","2. high":"283.5700","3. low":"283.4500","4. close":"283.4500","5. volume":"5"},"2025-07-11 18:40:00":{"1. open":"283.5694","2. high":"283.5694","3. low":"283.4500","4. close":"283.4501","5. volume":"19"},"2025-07-11 18:35:00":{"1. open":"283.4500","2. high":"283.5700","3. low":"283.4500","4. close":"283.5500","5. volume":"15"},"2025-07-11 18:30:00":{"1. open":"283.5900","2. high":"283.5900","3. low":"283.4500","4. close":"283.4500","5. volume":"776594"},"2025-07-11 18:25:00":{"1. open":"283.5000","2. high":"283.5000","3. low":"283.4500","4. close":"283.4500","5. volume":"22"},"2025-07-11 18:20:00":{"1. open":"283.5600","2. high":"283.5600","3. low":"283.5600","4. close":"283.5600","5. volume":"1"},"2025-07-11 18:15:00":{"1. open":"283.5000","2. high":"283.5684","3. low":"283.4500","4. close":"283.5684","5. volume":"43"},"2025-07-11 18:10:00":{"1. open":"283.5000","2. high":"283.5700","3. low":"283.5000","4. close":"283.5700","5. volume":"22"},"2025-07-11 18:05:00":{"1. open":"283.5699","2. high":"283.5700","3. low":"283.5300","4. close":"283.5700","5. volume":"25"},"2025-07-11 18:00:00":{"1. open":"283.3500","2. high":"283.5400","3. low":"283.3500","4. close":"283.5400","5. volume":"92"},"2025-07-11 17:55:00":{"1. open":"283.5700","2. high":"283.5700","3. low":"283.3500","4. close":"283.3500","5. volume":"10"},"2025-07-11 17:50:00":{"1. open":"283.5800","2. high":"283.5800","3. low":"283.1000","4. close":"283.3500","5. volume":"4"},"2025-07-11 17:45:00":{"1. open":"283.4800","2. high":"283.5800","3. low":"283.3500","4. close":"283.3500","5. volume":"334"},"2025-07-11 17:40:00":{"1. open":"283.4800","2. high":"283.5800","3. low":"283.1000","4. close":"283.5800","5. volume":"134"},"2025-07-11 17:35:00":{"1. open":"283.5000","2. high":"283.5000","3. low":"283.5000","4. close":"283.5000","5. volume":"1"},"2025-07-11 17:30:00":{"1. open":"283.5800","2. high":"283.5800","3. low":"283.5000","4. close":"283.5000","5. volume":"2"},"2025-07-11 17:25:00":{"1. open":"283.4000","2. high":"283.5800","3. low":"283.3300","4. close":"283.5700","5. volume":"60"},"2025-07-11 17:20:00":{"1. open":"283.4000","2. high":"283.5800","3. low":"283.3000","4. close":"283.5800","5. volume":"44"},"2025-07-11 17:15:00":{"1. open":"283.5000","2. high":"283.5000","3. low":"283.4000","4. close":"283.4000","5. volume":"58"},"2025-07-11 17:10:00":{"1. open":"283.5800","2. high":"283.5800","3. low":"283.5000","4. close":"283.5000","5. volume":"38"},"2025-07-11 17:05:00":{"1. open":"283.3400","2. high":"283.3400","3. low":"283.3100","4. close":"283.3100","5. volume":"52"},"2025-07-11 17:00:00":{"1. open":"283.5730","2. high":"283.5800","3. low":"283.3500","4. close":"283.5800","5. volume":"6"},"2025-07-11 16:55:00":{"1. open":"283.3500","2. high":"283.3500","3. low":"280.9700","4. close":"283.3000","5. volume":"1546"},"2025-07-11 16:50:00":{"1. open":"283.5900","2. high":"283.9000","3. low":"283.1000","4. close":"283.3500","5. volume":"2202"},"2025-07-11 16:45:00":{"1. open":"283.9000","2. high":"283.9000","3. low":"283.6200","4. close":"283.9000","5. volume":"28"},"2025-07-11 16:40:00":{"1. open":"283.5600","2. high":"283.8900","3. low":"283.5600","4. close":"283.8900","5. volume":"13380"},"2025-07-11 16:35:00":{"1. open":"283.5600","2. high":"283.5600","3. low":"283.3100","4. close":"283.5600","5. volume":"878"},"2025-07-11 16:30:00":{"1. open":"283.5000","2. high":"283.5900","3. low":"283.4400","4. close":"283.5600","5. volume":"173"},"2025-07-11 16:25:00":{"1. open":"283.4900","2. high":"283.5900","3. low":"283.4000","4. close":"283.5900","5. volume":"413"},"2025-07-11 16:20:00":{"1. open":"283.5900","2. high":"283.5900","3. low":"283.4000","4. close":"283.5000","5. volume":"2260"},"2025-07-11 16:15:00":{"1. open":"283.5900","2. high":"283.5900","3. low":"283.3000","4. close":"283.5560","5. volume":"78"},"2025-07-11 16:10:00":{"1. open":"283.5900","2. high":"283.5900","3. low":"283.3400","4. close":"283.5000","5. volume":"777085"},"2025-07-11 16:05:00":{"1. open":"283.3000","2. high":"283.5600","3. low":"283.3000","4. close":"283.3000","5. volume":"67"},"2025-07-11 16:00:00":{"1. open":"283.5100","2. high":"283.5900","3. low":"283.1300","4. close":"283.5600","5. volume":"1613801"},"2025-07-11 15:55:00":{"1. open":"283.2100","2. high":"283.6800","3. low":"283.0200","4. close":"283.5600","5. volume":"462493"},"2025-07-11 15:50:00":{"1. open":"283.2000","2. high":"283.3200","3. low":"283.0000","4. close":"283.1600","5. volume":"105793"},"2025-07-11 15:45:00":{"1. open":"283.2500","2. high":"283.4850","3. low":"282.9200","4. close":"283.2200","5. volume":"111176"},"2025-07-11 15:40:00":{"1. open":"283.6100","2. high":"283.6450","3. low":"283.1287","4. close":"283.3050","5. volume":"95801"},"2025-07-11 15:35:00":{"1. open":"283.8200","2. high":"283.9228","3. low":"283.5500","4. close":"283.6050","5. volume":"53864"},"2025-07-11 15:30:00":{"1. open":"284.0300","2. high":"284.1200","3. low":"283.8000","4. close":"283.8000","5. volume":"52150"},"2025-07-11 15:25:00":{"1. open":"283.9450","2. high":"284.1900","3. low":"283.8500","4. close":"284.0500","5. volume":"32811"},"2025-07-11 15:20:00":{"1. open":"283.6550","2. high":"283.9415","3. low":"283.6500","4. close":"283.9000","5. volume":"33082"},"2025-07-11 15:15:00":{"1. open":"284.0450","2. high":"284.0450","3. low":"283.6000","4. close":"283.6500","5. volume":"31636"},"2025-07-11 15:10:00":{"1. open":"284.0250","2. high":"284.0700","3. low":"283.7900","4. close":"284.0000","5. volume":"26524"},"2025-07-11 15:05:00":{"1. open":"283.7700","2. high":"284.0200","3. low":"283.4800","4. close":"284.0200","5. volume":"62243"},"2025-07-11 15:00:00":{"1. open":"284.0200","2. high":"284.0200","3. low":"283.7100","4. close":"283.8250","5. volume":"23290"},"2025-07-11 14:55:00":{"1. open":"284.1300","2. high":"284.1900","3. low":"283.9800","4. close":"284.0193","5. volume":"22407"},"2025-07-11 14:50:00":{"1. open":"284.1000","2. high":"284.2701","3. low":"284.0100","4. close":"284.1200","5. volume":"23205"},"2025-07-11 14:45:00":{"1. open":"284.1600","2. high":"284.2300","3. low":"284.0700","4. close":"284.0900","5. volume":"14890"},"2025-07-11 14:40:00":{"1. open":"284.0100","2. high":"284.2200","3. low":"284.0100","4. close":"284.1600","5. volume":"24978"},"2025-07-11 14:35:00":{"1. open":"284.2900","2. high":"284.3800","3. low":"283.9600","4. close":"284.0100","5. volume":"31593"},"2025-07-11 14:30:00":{"1. open":"284.3400","2. high":"284.4200","3. low":"284.2700","4. close":"284.3250","5. volume":"22477"},"2025-07-11 14:25:00":{"1. open":"284.5050","2. high":"284.5100","3. low":"284.2700","4. close":"284.3399","5. volume":"30188"},"2025-07-11 14:20:00":{"1. open":"284.5900","2. high":"284.6200","3. low":"284.3700","4. close":"284.5050","5. volume":"26903"},"2025-07-11 14:15:00":{"1. open":"284.7000","2. high":"284.7300","3. low":"284.5614","4. close":"284.6200","5. volume":"16837"},"2025-07-11 14:10:00":{"1. open":"284.7800","2. high":"284.9099","3. low":"284.6900","4. close":"284.8000","5. volume":"15967"},"2025-07-11 14:05:00":{"1. open":"284.7000","2. high":"284.8800","3. low":"284.7000","4. close":"284.7750","5. volume":"13543"},"2025-07-11 14:00:00":{"1. open":"284.7800","2. high":"285.0000","3. low":"284.6300","4. close":"284.7200","5. volume":"29594"},"2025-07-11 13:55:00":{"1. open":"284.5350","2. high":"284.8600","3. low":"284.5100","4. close":"284.7100","5. volume":"18871"},"2025-07-11 13:50:00":{"1. open":"284.2850","2. high":"284.6825","3. low":"284.2850","4. close":"284.5150","5. volume":"35198"},"2025-07-11 13:45:00":{"1. open":"284.5400","2. high":"284.5648","3. low":"284.2500","4. close":"284.2700","5. volume":"18659"},"2025-07-11 13:40:00":{"1. open":"284.4500","2. high":"284.6800","3. low":"284.2450","4. close":"284.4400","5. volume":"22788"},"2025-07-11 13:35:00":{"1. open":"284.6850","2. high":"284.7937","3. low":"284.3750","4. close":"284.3901","5. volume":"30757"},"2025-07-11 13:30:00":{"1. open":"284.8400","2. high":"285.0900","3. low":"284.6300","4. close":"284.6875","5. volume":"14747"},"2025-07-11 13:25:00":{"1. open":"284.4600","2. high":"284.8600","3. low":"284.4200","4. close":"284.8600","5. volume":"18273"},"2025-07-11 13:20:00":{"1. open":"284.7100","2. high":"284.7700","3. low":"284.4600","4. close":"284.4650","5. volume":"13908"},"2025-07-11 13:15:00":{"1. open":"284.7500","2. high":"284.7900","3. low":"284.5150","4. close":"284.7300","5. volume":"25209"},"2025-07-11 13:10:00":{"1. open":"284.8605","2. high":"284.8605","3. low":"284.6000","4. close":"284.7300","5. volume":"34083"},"2025-07-11 13:05:00":{"1. open":"284.6200","2. high":"284.9400","3. low":"284.6200","4. close":"284.8400","5. volume":"32243"},"2025-07-11 13:00:00":{"1. open":"284.9600","2. high":"284.9650","3. low":"284.6200","4. close":"284.6200","5. volume":"38208"},"2025-07-11 12:55:00":{"1. open":"284.5000","2. high":"284.9850","3. low":"284.5000","4. close":"284.9800","5. volume":"17860"},"2025-07-11 12:50:00":{"1. open":"284.5500","2. high":"284.5900","3. low":"284.3001","4. close":"284.4100","5. volume":"40044"},"2025-07-11 12:45:00":{"1. open":"284.7650","2. high":"284.9200","3. low":"284.3900","4. close":"284.5500","5. volume":"24586"},"2025-07-11 12:40:00":{"1. open":"284.9600","2. high":"285.0400","3. low":"284.7500","4. close":"284.8000","5. volume":"18724"},"2025-07-11 12:35:00":{"1. open":"284.9956","2. high":"285.0800","3. low":"284.7050","4. close":"284.9500","5. volume":"20096"},"2025-07-11 12:30:00":{"1. open":"285.1800","2. high":"285.2050","3. low":"284.7500","4. close":"284.9900","5. volume":"29758"},"2025-07-11 12:25:00":{"1. open":"285.6200","2. high":"285.6450","3. low":"285.1300","4. close":"285.1800","5. volume":"44557"},"2025-07-11 12:20:00":{"1. open":"285.7500","2. high":"286.1300","3. low":"285.6700","4. close":"285.6950","5. volume":"81514"},"2025-07-11 12:15:00":{"1. open":"285.5900","2. high":"285.7750","3. low":"285.5900","4. close":"285.7400","5. volume":"18889"},"2025-07-11 12:10:00":{"1. open":"285.6400","2. high":"285.7700","3. low":"285.5500","4. close":"285.5800","5. volume":"16102"},"2025-07-11 12:05:00":{"1. open":"285.6400","2. high":"285.7200","3. low":"285.5300","4. close":"285.7000","5. volume":"30848"},"2025-07-11 12:00:00":{"1. open":"285.8000","2. high":"286.0500","3. low":"285.6600","4. close":"285.6700","5. volume":"19210"},"2025-07-11 11:55:00":{"1. open":"285.8200","2. high":"285.9700","3. low":"285.6900","4. close":"285.8100","5. volume":"10368"},"2025-07-11 11:50:00":{"1. open":"285.9600","2. high":"285.9700","3. low":"285.7400","4. close":"285.8240","5. volume":"14417"},"2025-07-11 11:45:00":{"1. open":"286.0100","2. high":"286.0899","3. low":"285.7100","4. close":"285.9950","5. volume":"20910"},"2025-07-11 11:40:00":{"1. open":"286.0000","2. high":"286.0000","3. low":"285.7700","4. close":"285.9350","5. volume":"16864"},"2025-07-11 11:35:00":{"1. open":"285.8200","2. high":"286.0000","3. low":"285.6501","4. close":"285.9550","5. volume":"18679"},"2025-07-11 11:30:00":{"1. open":"285.7700","2. high":"285.9600","3. low":"285.6800","4. close":"285.9150","5. volume":"19902"}},"weekly":{"2025-07-11":{"1. open":"292.5000","2. high":"295.6100","3. low":"282.2100","4. close":"283.5900","5. volume":"17664449"},"2025-07-03":{"1. open":"290.9300","2. high":"295.1081","3. low":"286.9000","4. close":"291.9700","5. volume":"11878987"},"2025-06-27":{"1. open":"281.6500","2. high":"296.1600","3. low":"280.2100","4. close":"289.7000","5. volume":"19051199"},"2025-06-20":{"1. open":"279.3050","2. high":"286.9100","3. low":"277.2000","4. close":"280.9700","5. volume":"17965949"},"2025-06-13":{"1. open":"268.1000","2. high":"283.0600","3. low":"266.7100","4. close":"277.2200","5. volume":"20812836"},"2025-06-06":{"1. open":"257.8500","2. high":"270.1700","3. low":"257.2200","4. close":"268.8700","5. volume":"13070565"}},"monthly":{"2025-07-11":{"1. open":"294.5500","2. high":"295.6100","3. low":"282.2100","4. close":"283.5900","5. volume":"26048050"},"2025-06-30":{"1. open":"257.8500","2. high":"296.1600","3. low":"257.2200","4. close":"294.7800","5. volume":"74395935"},"2025-05-30":{"1. open":"241.4400","2. high":"269.2800","3. low":"237.9450","4. close":"259.0600","5. volume":"78164014"},"2025-04-30":{"1. open":"248.0300","2. high":"252.7900","3. low":"214.5000","4. close":"241.8200","5. volume":"120775331"},"2025-03-31":{"1. open":"254.7350","2. high":"266.4500","3. low":"237.2240","4. close":"248.6600","5. volume":"100813990"},"2025-02-28":{"1. open":"252.4000","2. high":"265.7200","3. low":"246.5400","4. close":"252.4400","5. volume":"94123851"}},"global_quote":{"01. symbol":"IBM","02. open":"285.0100","03. high":"287.4300","04. low":"282.9200","05. price":"283.5900","06. volume":"3790679","07. latest trading day":"2025-07-11","08. previous close":"287.4300","09. change":"-3.8400","10. change percent":"-1.3360%"},"search_results":[{"1. symbol":"IBM","2. name":"International Business Machines Corp","3. type":"Equity","4. region":"United States","5. marketOpen":"09:30","6. marketClose":"16:00","7. timezone":"UTC-04","8. currency":"USD","9. matchScore":"1.0000"},{"1. symbol":"IBMN","2. name":"ISHARES IBONDS DEC 2025 TERM MUNI BOND ETF ","3. type":"ETF","4. region":"United States","5. marketOpen":"09:30","6. marketClose":"16:00","7. timezone":"UTC-04","8. currency":"USD","9. matchScore":"0.8571"},{"1. symbol":"IBMO","2. name":"ISHARES IBONDS DEC 2026 TERM MUNI BOND ETF ","3. type":"ETF","4. region":"United States","5. marketOpen":"09:30","6. marketClose":"16:00","7. timezone":"UTC-04","8. currency":"USD","9. matchScore":"0.8571"},{"1. symbol":"IBMP","2. name":"ISHARES IBONDS DEC 2027 TERM MUNI BOND ETF ","3. type":"ETF","4. region":"United States","5. marketOpen":"09:30","6. marketClose":"16:00","7. timezone":"UTC-04","8. currency":"USD","9. matchScore":"0.8571"},{"1. symbol":"IBMQ","2. name":"ISHARES IBONDS DEC 2028 TERM MUNI BOND ETF ","3. type":"ETF","4. region":"United States","5. marketOpen":"09:30","6. marketClose":"16:00","7. timezone":"UTC-04","8. currency":"USD","9. matchScore":"0.8571"},{"1. symbol":"IBMR","2. name":"ISHARES IBONDS DEC 2029 TERM MUNI BOND ETF ","3. type":"ETF","4. region":"United States","5. marketOpen":"09:30","6. marketClose":"16:00","7. timezone":"UTC-04","8. currency":"USD","9. matchScore":"0.8571"},{"1. symbol":"IBM.FRK","2. name":"International Business Machines","3. type":"Equity","4. region":"Frankfurt","5. marketOpen":"08:00","6. marketClose":"20:00","7. timezone":"UTC+02","8. currency":"EUR","9. matchScore":"0.7500"},{"1. symbol":"IBM.DEX","2. name":"International Business Machines","3. type":"Equity","4. region":"XETRA","5. marketOpen":"08:00","6. marketClose":"20:00","7. timezone":"UTC+02","8. currency":"EUR","9. matchScore":"0.6667"},{"1. symbol":"IBM0.FRK","2. name":"IBM CDR","3. type":"Equity","4. region":"Frankfurt","5. marketOpen":"08:00","6. marketClose":"20:00","7. timezone":"UTC+02","8. currency":"EUR","9. matchScore":"0.6667"},{"1. symbol":"IBMB34.SAO","2. name":"International Business Machines Corp","3. type":"Equity","4. region":"Brazil/Sao Paolo","5. marketOpen":"10:00","6. marketClose":"17:30","7. timezone":"UTC-03","8. currency":"BRL","9. matchScore":"0.5000"}],"market_status":{"endpoint":"Global Market Open & Close Status","markets":[{"market_type":"Equity","region":"United States","primary_exchanges":"NASDAQ, NYSE, AMEX, BATS","local_open":"09:30","local_close":"16:15","current_status":"closed","notes":""},{"market_type":"Equity","region":"Canada","primary_exchanges":"Toronto, Toronto Ventures","local_open":"09:30","local_close":"16:00","current_status":"closed","notes":""},{"market_type":"Equity","region":"United Kingdom","primary_exchanges":"London","local_open":"08:00","local_close":"16:30","current_status":"closed","notes":""},{"market_type":"Equity","region":"Germany","primary_exchanges":"XETRA, Berlin, Frankfurt, Munich, Stuttgart","local_open":"08:00","local_close":"20:00","current_status":"closed","notes":""},{"market_type":"Equity","region":"France","primary_exchanges":"Paris","local_open":"09:00","local_close":"17:30","current_status":"closed","notes":""},{"market_type":"Equity","region":"Spain","primary_exchanges":"Barcelona, Madrid","local_open":"09:00","local_close":"17:30","current_status":"closed","notes":""},{"market_type":"Equity","region":"Portugal","primary_exchanges":"Lisbon","local_open":"08:00","local_close":"16:30","current_status":"closed","notes":""},{"market_type":"Equity","region":"Japan","primary_exchanges":"Tokyo","local_open":"09:00","local_close":"15:00","current_status":"closed","notes":"Noon trading break from 11:30 to 12:30 local time"},{"market_type":"Equity","region":"India","primary_exchanges":"NSE, BSE","local_open":"09:15","local_close":"15:30","current_status":"closed","notes":""},{"market_type":"Equity","region":"Mainland China","primary_exchanges":"Shanghai, Shenzhen","local_open":"09:30","local_close":"15:00","current_status":"closed","notes":"Noon trading break from 11:30 to 13:00 local time"},{"market_type":"Equity","region":"Hong Kong","primary_exchanges":"Hong Kong","local_open":"09:30","local_close":"16:00","current_status":"closed","notes":"Noon trading break from 12:00 to 13:00 local time"},{"market_type":"Equity","region":"Brazil","primary_exchanges":"Sao Paolo","local_open":"10:00","local_close":"17:30","current_status":"closed","notes":""},{"market_type":"Equity","region":"Mexico","primary_exchanges":"Mexico","local_open":"08:30","local_close":"15:00","current_status":"closed","notes":""},{"market_type":"Equity","region":"South Africa","primary_exchanges":"Johannesburg","local_open":"09:00","local_close":"17:00","current_status":"closed","notes":""},{"market_type":"Forex","region":"Global","primary_exchanges":"Global","local_open":"00:00","local_close":"23:59","current_status":"closed","notes":"The forex market is open 24 hours a day, EXCEPT between 16:00 EST on Friday and 17:00 EST on Sunday"},{"market_type":"Cryptocurrency","region":"Global","primary_exchanges":"Global","local_open":"00:00","local_close":"23:59","current_status":"open","notes":"The cryptocurrency market is open 24 hours a day"}]}}
"""
#requestApi("IBM","5min")
